# 深度学习编译系统

# 计算图

计算图用来表示深度学习网络模型在训练和推理过程中计算逻辑和状态的工具，由Tensor、算子Operator以及有向线段表示张良状态和依赖关系

作用：
1. 对输入数据、算子、算子执行顺序进行统一表达
2. 定义中间状态和模型状态，便于框架管理内存
3. 自动化分析模型定义，计算梯度
4. 分析算子执行关系，发现将算子进行异步执行的机会

分类：
1. 静态图
2. 动态图

静态图：在代码执行前生成正反图并完成编译优化（Tracing,AST模式）

动态图：利用相关机制注册算子，并解析执行，便于用户编写调试

类型系统：
1. 定义了类型的集合
2. 类型规定程序行为的规则，定义不同类型/指定类型之间的相互作用

静态分析：在不实际运行程序的情况下，通过词法分析，语法分析，控制流，数据流分析等技术对代码进行分析验证

# 前端

硬件无关优化

自动微分

# 计算图优化

High-Level IR: 隐藏了底层运行细节，无法直接映射到目标设备上的算子

计算图优化：对High-level IR 的各个节点进行拆分和融合，转化位可在硬件上执行的low-level IR

通用硬件优化：模式匹配特定结构的子图（算子融合，自动算子生成，图算融合）

特定硬件优化：考虑硬件指令，优化存储格式

# 后端

算子选择

后端与运行时：内存分配与计算调度执行

# 模型训练

分布式训练：数据并行，模型并行（算子内并行，算子间并行），混合并行，流水线并行

# 硬件平台

CPU GPU

GPU : 更多ALU

FPGA：

ASIC: 专用集成电路（全定制） TPU NPU BPU Nervana DPU XPU

类脑芯片：